import{B as O,r as l,R as P,j as e,i as F,z as q,b as o,y as G,m as M,e as V,f as W,g as H,h as J,o as K,A as Q,t as T,k as h}from"./vendor-wMn6iGPg.js";import{m,k as X,n as Y,o as Z,p as $,q as ee,t as te,v as b,a as se,u as v}from"./index-8i8i33M2.js";import{r as ae}from"./image-alM4RakH.js";import{I as ne,a as re}from"./InputPhoneNumber-SsZOZmFL.js";import{D as ie}from"./DeleteIcon-6Ouv8ePB.js";import{L as le}from"./Loader-NBEW4Gnn.js";function j({bussinessId:n,event:i,bussiness:u}){const c=m(t=>t.setEvents),{isOpen:s,onOpen:E,onOpenChange:y}=O(),[_,g]=l.useState(!1),[I,w]=l.useState(""),[C,N]=l.useState(null),[oe,d]=l.useState(0),[k,x]=l.useState(!1),L={id:"",bussiness:n??"",name:"",image:"",description:"",email:"",phone_number:""},p=async()=>{const t=await b(n);c(t)},a=P.useRef(i??L),S=async()=>{x(!0),console.log(i.id),await Z(i.id),console.log("here"),await p(),x(!1)},D=async()=>{g(!0);let t="";a.current.image!==null&&a.current.image!==""&a.current.image instanceof Blob&&(await $(a.current.image,"events"),t=await ee(a.current.image,I,"events"),t=t!==null?t.path:"");const r={...a.current,image:t};await te(r),Q.success("Evento actualizado satisfactoriamente"),g(!1),await p()},R=async t=>{if(t.target.files&&t.target.files[0]){const r=t.target.files[0];N(URL.createObjectURL(r));const f=r.name.split(".").pop(),B=f.toLowerCase(),U=r.name.replace(f,B),z=await ae(r,400);w(U),a.current={...a.current,image:z},d(A=>A+1)}};return e.jsxs("div",{style:{padding:"5px"},children:[i&&e.jsx("section",{style:{width:"100%",display:"flex",justifyContent:"flex-end"},children:e.jsx("span",{className:"text-danger",onClick:E,children:e.jsx(ie,{})})}),e.jsx("br",{}),e.jsx(F,{type:"text",label:"Nombre del evento",variant:"bordered",placeholder:"Escribe el nombre del evento",labelPlacement:"outside",value:a.current.name,onChange:t=>{a.current={...a.current,name:t.target.value},d(r=>r+1)}}),e.jsxs("div",{children:[e.jsx("input",{type:"file",id:"logoImageUpload",accept:"image/*",style:{display:"none"},onChange:R}),e.jsx("br",{}),e.jsx("div",{style:X,children:e.jsx(q,{width:272,height:272,alt:"Imagen del evento",src:C||a.current.image})}),e.jsx(o,{style:{color:"white"},color:"secondary",onClick:()=>document.getElementById("logoImageUpload").click(),className:"mt-2",children:"Subir foto del evento"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(G,{label:"Descripción",labelPlacement:"outside",style:{width:"300px",height:"230px"},placeholder:"Escribe la descripción del evento",variant:"bordered",value:a.current.description,onChange:t=>{a.current={...a.current,description:t.target.value},d(r=>r+1)}})]}),e.jsx("br",{}),e.jsxs("div",{style:Y,className:"mt-2 mb-2",children:[e.jsx(ne,{value:a}),e.jsx(re,{value:a})]}),e.jsx("br",{}),_&&e.jsx(le,{text:"Espere mientras se crea el evento"}),e.jsx(o,{color:"secondary",className:"text-white mt-2",onClick:D,children:"Agregar Evento"}),e.jsx(M,{isOpen:s,onOpenChange:y,isDismissable:!1,children:e.jsx(V,{children:t=>e.jsxs(e.Fragment,{children:[e.jsxs(W,{className:"flex flex-col gap-1",children:["Eliminar ",i.name]}),e.jsx(H,{children:e.jsx("p",{children:"Si eliminas este evento no podrás recuperarlo."})}),e.jsxs(J,{children:[e.jsx(o,{color:"danger",variant:"flat",onClick:t,children:"cerrar"}),e.jsx(o,{color:"primary",onClick:()=>{S(),t()},children:k?"Eliminando...":"Eliminar"})]})]})})}),e.jsx(K,{richColors:!0,duration:3e3,position:"bottom-center",theme:"dark"})]})}function pe(){se(s=>s.user);const n=v(s=>s.bussiness);v(s=>s.setBussiness);const i=m(s=>s.events),u=m(s=>s.setEvents),c=async()=>{const s=await b(n.id);u(s)};return l.useEffect(()=>{n&&c()},[n]),e.jsxs(T,{"aria-label":"seleccion de eventos",fullWidth:!0,children:[e.jsx(h,{title:"Crear Evento",children:(n==null?void 0:n.id)&&e.jsx(j,{bussinessId:n.id})},"create"),i.map(s=>e.jsx(h,{title:s.name,children:e.jsx(j,{bussinessId:n.id,bussiness:n,event:s})},s.id))]})}export{pe as default};
