import{r as V,B as E,R as l,j as a,C as g,a as I,i as j,D as L,E as w,F as T,G as F,H as M,I as O,J as R,K,M as G}from"./vendor-wMn6iGPg.js";import{D as H}from"./DeleteIcon-6Ouv8ePB.js";import{S as J}from"./SearchIcon-tx4-ixfu.js";import{D as W}from"./DeleteBussinessModal-y_Rtb970.js";import{A as q,B as z,C as v,D as Q}from"./index-8i8i33M2.js";const U=[{name:"Nombre",uid:"name"},{name:"Dueño",uid:"owner"},{name:"Foto de portada",uid:"front_pic"},{name:"Dirección",uid:"address"},{name:"Provincia",uid:"province"},{name:"Teléfono",uid:"phone"},{name:"Privilegios",uid:"privileges"},{name:"Acciones",uid:"actions"}],X=async(r,n)=>{await q(n,r.target.checked)};function Y({bussinessList:r,getAllBussinesses:n}){const[i,t]=V.useState(null),{isOpen:_,onOpen:C,onOpenChange:y}=E(),N=l.useCallback((e,o)=>{const D=async(c,P)=>{const S=parseInt(c.target.value,10);try{await z(P,S),await n()}catch(k){console.error(k)}},f=e.columnKey;switch(o){case"name":return a.jsx(w,{avatarProps:{radius:"sm",src:e.perfil_pic},name:e.name,children:e.name});case"owner":return e!=null&&e.owner?a.jsx(w,{avatarProps:{radius:"lg",src:e!=null&&e.owner?e.owner.avatar_pic:null},description:e!=null&&e.owner?e.owner.name:null,name:f,children:e!=null&&e.owner?e.owner.phone_number:null}):a.jsx("p",{children:"N/A"});case"front_pic":return a.jsx(L,{isBordered:!0,radius:"sm",src:e.front_pic?e.front_pic:null});case"address":return a.jsx("p",{children:e.address||"N/A"});case"province":return a.jsx("p",{children:e.province||"N/A"});case"phone":return a.jsx("p",{children:e.phone_number||"N/A"});case"privileges":return a.jsx(j,{type:"number",defaultValue:e.privileges,onChange:c=>D(c,e.id)});case"actions":return a.jsxs("div",{className:"relative flex items-center gap-2",children:[a.jsx("div",{children:a.jsx(g,{color:"primary",content:"Activar o desactivar negocio",children:a.jsx("span",{className:"text-lg text-danger cursor-pointer active:opacity-50",children:a.jsx(I,{isSelected:e.isActive,onValueChange:c=>X(c,e.id)})})})}),a.jsx(g,{color:"danger",content:"Eliminar negocio",children:a.jsx("span",{onClick:()=>{t(e),C()},className:"text-lg text-danger cursor-pointer active:opacity-50",children:a.jsx(H,{})})})]});default:return f||"N/A"}},[]),[p,m]=l.useState(""),[s,h]=l.useState(1),d=4,u=r.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())),A=Math.ceil(u.length/d),B=l.useMemo(()=>{const e=(s-1)*d,o=e+d;return u.slice(e,o)},[s,u]),x=l.useCallback(e=>{e?(m(e),h(1)):m("")},[]);return a.jsx("div",{className:"py-2 px-2 grid justify-between items-center m-2",style:{justifyContent:"center",padding:"20px",width:"100%",display:"grid"},children:a.jsxs("div",{style:{maxWidth:"1600px"},children:[a.jsx(j,{isClearable:!0,className:"w-full lg:max-w-[40%] mb-2",placeholder:"Search by name...",startContent:a.jsx(J,{}),value:p,onClear:()=>x(""),onValueChange:x}),a.jsxs(T,{"aria-label":"Bussiness Table",bottomContent:a.jsx("div",{className:"flex w-full justify-center",children:a.jsx(F,{className:"text-white",isCompact:!0,showControls:!0,showShadow:!0,color:"secondary",page:s,total:A,onChange:e=>h(e)})}),classNames:{wrapper:"min-h-[222px]"},children:[a.jsx(M,{columns:U,children:e=>a.jsx(O,{align:e.uid==="actions"?"center":"start",children:e.name},e.uid)}),a.jsx(R,{items:B,children:e=>a.jsx(K,{children:o=>a.jsx(G,{children:N(e,o)})},e.id)})]}),a.jsx(W,{isOpen:_,onOpenChange:y,bussinessToDelete:i,getAllBussinesses:n})]})})}function te(){const r=v(t=>t.bussiness),n=v(t=>t.setBussiness),i=async()=>{const t=await Q();n(t)};return l.useEffect(()=>{r.length===0&&i()},[]),a.jsx(a.Fragment,{children:a.jsx(Y,{bussinessList:r,getAllBussinesses:i})})}export{te as default};
