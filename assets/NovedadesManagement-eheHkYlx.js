import{B as w,r,R as C,j as e,i as D,y as k,b as c,m as L,e as A,f as R,g as S,h as B,o as I,A as O,t as z,k as p}from"./vendor-wMn6iGPg.js";import{w as u,x as P,y as q,z as b,u as F}from"./index-8i8i33M2.js";import{L as M}from"./Loader-NBEW4Gnn.js";import{D as V}from"./DeleteIcon-6Ouv8ePB.js";function j({bussinessId:a,event:d}){const o=u(t=>t.setNovedades),{isOpen:l,onOpen:s,onOpenChange:g}=w(),[N,x]=r.useState(!1),[_,m]=r.useState(!1),[W,f]=r.useState(0),h={id:"",bussiness:a??"",name:"",text:""},v=async()=>{const t=await b(a);o(t)},n=C.useRef(d??h),y=async()=>{m(!0),await P(d.id),await v(),m(!1)},E=async()=>{x(!0);const t={bussiness:n.current.bussiness,name:n.current.name,text:n.current.text};await q(t),O.success("Novedad actualizada satisfactoriamente"),x(!1),n.current=h,await v()};return e.jsxs("div",{style:{padding:"5px"},children:[d&&e.jsx("section",{style:{width:"100%",display:"flex",justifyContent:"flex-end"},children:e.jsx("span",{className:"text-danger",onClick:s,children:e.jsx(V,{})})}),e.jsx("br",{}),e.jsx(D,{type:"text",label:"Nombre del evento",variant:"bordered",placeholder:"Escribe el nombre del evento",labelPlacement:"outside",value:n.current.name,onChange:t=>{n.current={...n.current,name:t.target.value},f(i=>i+1)}}),e.jsx("br",{}),e.jsx(k,{label:"Novedad",labelPlacement:"outside",style:{width:"300px",height:"230px"},placeholder:"Escribe una novedad, esta puede ser una oferta de trabajo, una promoción o cualquier cosa",variant:"bordered",value:n.current.text,onChange:t=>{n.current={...n.current,text:t.target.value},f(i=>i+1)}}),e.jsx("br",{}),N&&e.jsx(M,{text:"Espere mientras se añade la novedad"}),e.jsx(c,{color:"secondary",className:"text-white mt-2",onClick:E,children:"Agregar Novedad"}),e.jsx(L,{isOpen:l,onOpenChange:g,isDismissable:!1,children:e.jsx(A,{children:t=>e.jsxs(e.Fragment,{children:[e.jsxs(R,{className:"flex flex-col gap-1",children:["Eliminar ",d.name]}),e.jsx(S,{children:e.jsx("p",{children:"Si eliminas este evento no podrás recuperarlo."})}),e.jsxs(B,{children:[e.jsx(c,{color:"danger",variant:"flat",onClick:t,children:"cerrar"}),e.jsx(c,{color:"primary",onClick:()=>{y(),t()},children:_?"Eliminando...":"Eliminar"})]})]})})}),e.jsx(I,{richColors:!0,duration:3e3,position:"bottom-center",theme:"dark"})]})}function Q(){const a=F(s=>s.bussiness),d=u(s=>s.novedades),o=u(s=>s.setNovedades),l=async()=>{const s=await b(a.id);o(s)};return r.useEffect(()=>{a&&l()},[a]),e.jsxs(z,{"aria-label":"seleccion de eventos",fullWidth:!0,children:[e.jsx(p,{title:"Agregar Novedad",children:(a==null?void 0:a.id)&&e.jsx(j,{bussinessId:a.id})},"create"),d.map(s=>e.jsx(p,{title:s.name,children:e.jsx(j,{bussinessId:a.id,bussiness:a,event:s})},s.id))]})}export{Q as default};
